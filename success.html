<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmed | ESSENTIALS</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand': {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            font-family: 'Inter', system-ui, sans-serif;
        }

        .success-animation {
            animation: scaleIn 0.5s ease forwards;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .checkmark {
            animation: checkmark 0.5s ease 0.3s forwards;
            stroke-dasharray: 50;
            stroke-dashoffset: 50;
        }

        @keyframes checkmark {
            to {
                stroke-dashoffset: 0;
            }
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #22c55e;
            animation: confetti 1s ease forwards;
        }

        @keyframes confetti {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(-100px) rotate(720deg);
                opacity: 0;
            }
        }
    </style>
</head>

<body class="bg-brand-50 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl p-8 md:p-12 max-w-lg w-full text-center">
        <!-- Success Icon -->
        <div
            class="success-animation w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-8">
            <svg class="w-12 h-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path class="checkmark" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                    d="M5 13l4 4L19 7" />
            </svg>
        </div>

        <!-- Title -->
        <h1 class="text-3xl font-semibold text-brand-900 mb-3">Payment Successful!</h1>
        <p class="text-brand-600 mb-6">Thank you for your purchase. Your order has been confirmed.</p>

        <!-- Order Details -->
        <div id="order-details" class="bg-brand-50 rounded-xl p-6 mb-8 text-left">
            <div class="flex justify-between items-center mb-3">
                <span class="text-sm text-brand-500">Order Status</span>
                <span class="text-sm font-medium text-green-600 bg-green-100 px-3 py-1 rounded-full">Paid</span>
            </div>
            <div class="flex justify-between items-center mb-3">
                <span class="text-sm text-brand-500">Email</span>
                <span id="customer-email" class="text-sm font-medium text-brand-800">Loading...</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-sm text-brand-500">Total Paid</span>
                <span id="amount-paid" class="text-lg font-bold text-brand-900">$0.00</span>
            </div>
        </div>

        <!-- Info -->
        <p class="text-sm text-brand-500 mb-8">
            A confirmation email has been sent to your email address with the order details.
        </p>

        <!-- Continue Shopping Button -->
        <a href="index.html"
            class="inline-block w-full py-4 bg-brand-900 text-white font-semibold rounded-lg hover:bg-brand-800 transition-colors">
            Continue Shopping
        </a>

        <!-- Stripe Badge -->
        <div class="mt-6 flex items-center justify-center gap-2 text-brand-400">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path
                    d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 100-16 8 8 0 000 16zm-1-5h2v2h-2v-2zm0-8h2v6h-2V7z" />
            </svg>
            <span class="text-xs">Secured by Stripe</span>
        </div>
    </div>

    <script>
        // Clear cart on success page load
        localStorage.removeItem('essentials_cart');

        // Get session ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const sessionId = urlParams.get('session_id');

        if (sessionId) {
            // Verify the session with the server
            fetch(`/verify-session?session_id=${sessionId}`)
                .then(res => res.json())
                .then(data => {
                    if (data.status === 'paid') {
                        document.getElementById('customer-email').textContent = data.customerEmail || 'N/A';
                        document.getElementById('amount-paid').textContent = `$${data.amountTotal.toFixed(2)}`;
                    }
                })
                .catch(err => {
                    console.error('Error verifying session:', err);
                });
        }
    </script>
</body>

</html>